

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tedana.combine.make_optcom &mdash; tedana 25.1.1a3.dev2+ge0932906e documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=ef81f6ce" />

  
    <link rel="shortcut icon" href="../_static/tedana_favicon.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=643184eb"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="https://cdn.rawgit.com/chrisfilo/zenodo.js/v0.1/zenodo.js"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/versions.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tedana.decomposition.tedpca" href="tedana.decomposition.tedpca.html" />
    <link rel="prev" title="tedana.decay.fit_decay_ts" href="tedana.decay.fit_decay_ts.html" /> 
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="tedana" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/generated/tedana.combine.make_optcom.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tedana
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi-echo.html">About multi-echo fMRI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Using tedana from the command line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../approach.html">tedana’s denoising approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outputs.html">Outputs of tedana</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_decision_trees.html">Understanding and building a component selection process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support and communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to tedana</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">The tedana roadmap</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.workflows"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.workflows</span></code>: Common workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.decay"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.decay</span></code>: Modeling signal decay across echoes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-tedana.combine"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.combine</span></code>: Combining time series across echoes</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.combine</span></code>.make_optcom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tedana.combine.make_optcom"><code class="docutils literal notranslate"><span class="pre">make_optcom()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.decomposition"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.decomposition</span></code>: Data decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.metrics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.metrics</span></code>: Computing TE-dependence metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.selection"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.selection</span></code>: Component selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.gscontrol"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.gscontrol</span></code>: Global signal control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.io"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.io</span></code>: Reading and writing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.reporting"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.reporting</span></code>: Reporting functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.stats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.stats</span></code>: Statistical functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.bibtex"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.bibtex</span></code>: Tools for working with BibTeX files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-tedana.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.utils</span></code>: Utility functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../denoising.html">Denoising Data with Components</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ME-ICA/tedana/releases">What's New</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tedana</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API</a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.combine</span></code>.make_optcom</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/tedana.combine.make_optcom.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tedana-combine-make-optcom">
<h1><a class="reference internal" href="../api.html#module-tedana.combine" title="tedana.combine"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tedana.combine</span></code></a>.make_optcom<a class="headerlink" href="#tedana-combine-make-optcom" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="tedana.combine.make_optcom">
<span class="sig-name descname"><span class="pre">make_optcom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2s'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/me-ica/tedana/blob/e093290/tedana/combine.py#L101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tedana.combine.make_optcom" title="Link to this definition"></a></dt>
<dd><p>Optimally combine BOLD data across TEs.</p>
<p>Optimally combine BOLD data across TEs, using only those echos with reliable signal
across at least three echos. If the number of echos providing reliable signal is greater
than three but less than the total number of collected echos, we assume that later
echos do not provided meaningful signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> ((S x E x T) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Concatenated BOLD data.</p></li>
<li><p><strong>tes</strong> ((E,) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Array of TEs, in seconds.</p></li>
<li><p><strong>adaptive_mask</strong> ((S,) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Array where each value indicates the number of echoes with good signal
for that voxel. This mask may be thresholded; for example, with values
less than 3 set to 0.
For more information on thresholding, see <cite>make_adaptive_mask</cite>.</p></li>
<li><p><strong>t2s</strong> ((S [x T]) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> or None, optional) – Estimated T2* values. Only required if combmode = ‘t2s’.
Default is None.</p></li>
<li><p><strong>combmode</strong> (<em>{‘t2s’, ‘paid’}, optional</em>) – How to combine data. Either ‘paid’ or ‘t2s’. If ‘paid’, argument ‘t2s’
is not required. Default is ‘t2s’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>combined</strong> ((S x T) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Optimally combined data.</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This function supports both the <code class="docutils literal notranslate"><span class="pre">'t2s'</span></code> method <a class="footnote-reference brackets" href="#footcite-posse1999enhancement" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>
and the <code class="docutils literal notranslate"><span class="pre">'paid'</span></code> method <a class="footnote-reference brackets" href="#footcite-poser2006bold" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.
The <code class="docutils literal notranslate"><span class="pre">'t2s'</span></code> method operates according to the following logic:</p>
<ol class="arabic">
<li><p>Estimate voxel- and TE-specific weights based on estimated <img class="math" src="../_images/math/e1a532bc5e84b68ad4c41c707fdda9bad507cb4c.png" alt="T_2^*"/>:</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/7f1dd86a36194af8e6bce6aca9c4775f9a67ae2c.png" alt="w(T_2^*)_n = \frac{TE_n * exp(\frac{-TE}\
{T_{2(est)}^*})}{\sum TE_n * exp(\frac{-TE}{T_{2(est)}^*})}"/></p>
</div></div></blockquote>
</li>
<li><p>Perform weighted average per voxel and TR across TEs based on weights
estimated in the previous step.</p></li>
</ol>
</div>
<p class="rubric">References</p>
<div class="docutils container" id="id3">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-posse1999enhancement" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Stefan Posse, Stefan Wiese, Daniel Gembris, Klaus Mathiak, Christoph Kessler, Maria-Liisa Grosse-Ruyken, Barbara Elghahwagi, Todd Richards, Stephen R Dager, and Valerij G Kiselev. Enhancement of bold-contrast sensitivity by single-shot multi-echo functional mr imaging. <em>Magnetic Resonance in Medicine: An Official Journal of the International Society for Magnetic Resonance in Medicine</em>, 42(1):87–97, 1999. URL: <a class="reference external" href="https://doi.org/10.1002/(SICI)1522-2594(199907)42:1&lt;87::AID-MRM13&gt;3.0.CO;2-O">https://doi.org/10.1002/(SICI)1522-2594(199907)42:1&lt;87::AID-MRM13&gt;3.0.CO;2-O</a>, <a class="reference external" href="https://doi.org/10.1002/(SICI)1522-2594(199907)42:1&lt;87::AID-MRM13&gt;3.0.CO;2-O">doi:10.1002/(SICI)1522-2594(199907)42:1&lt;87::AID-MRM13&gt;3.0.CO;2-O</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-poser2006bold" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Benedikt A Poser, Maarten J Versluis, Johannes M Hoogduin, and David G Norris. Bold contrast sensitivity enhancement and artifact reduction with multiecho epi: parallel-acquired inhomogeneity-desensitized fmri. <em>Magnetic Resonance in Medicine: An Official Journal of the International Society for Magnetic Resonance in Medicine</em>, 55(6):1227–1235, 2006. URL: <a class="reference external" href="https://doi.org/10.1002/mrm.20900">https://doi.org/10.1002/mrm.20900</a>, <a class="reference external" href="https://doi.org/10.1002/mrm.20900">doi:10.1002/mrm.20900</a>.</p>
</aside>
</aside>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="tedana.utils.make_adaptive_mask.html#tedana.utils.make_adaptive_mask" title="tedana.utils.make_adaptive_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">tedana.utils.make_adaptive_mask()</span></code></a></dt><dd><p>The function used to create the <code class="docutils literal notranslate"><span class="pre">adaptive_mask</span></code> parameter.</p>
</dd>
</dl>
</div>
</dd></dl>

<div class="clearer"></div></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tedana.decay.fit_decay_ts.html" class="btn btn-neutral float-left" title="tedana.decay.fit_decay_ts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tedana.decomposition.tedpca.html" class="btn btn-neutral float-right" title="tedana.decomposition.tedpca" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2025, tedana developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>