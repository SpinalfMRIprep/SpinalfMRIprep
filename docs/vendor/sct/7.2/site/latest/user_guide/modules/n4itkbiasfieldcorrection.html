

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>N4ITK MRI Bias correction &mdash; 3D Slicer  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=0defd4e4" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <script src="../../_static/js/versions.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CheckerBoard Filter" href="checkerboardfilter.html" />
    <link rel="prev" title="Multiply Scalar Volumes" href="multiplyscalarvolumes.html" /> 
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="slicer" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/user_guide/modules/n4itkbiasfieldcorrection.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            3D Slicer
              <img src="../../_static/3D-Slicer-Mark.png" class="logo" alt="Logo"/>
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About 3D Slicer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_help.html">Get Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_interface.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinate_systems.html">Coordinate systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_loading_and_saving.html">Data Loading and Saving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../image_segmentation.html">Image Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../registration.html">Registration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="dicom.html">DICOM</a></li>
<li class="toctree-l2"><a class="reference internal" href="markups.html">Markups</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sceneviews.html">Scene Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentations.html">Segmentations</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmenteditor.html">Segment editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="slicerwelcome.html">Welcome</a></li>
<li class="toctree-l2"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewcontrollers.html">View Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="volumerendering.html">Volume rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="volumes.html">Volumes</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#wizards">Wizards</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#informatics">Informatics</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#registration">Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#segmentation">Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#quantification">Quantification</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sequences">Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#diffusion">Diffusion</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#filtering">Filtering</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="addscalarvolumes.html">Add Scalar Volumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="castscalarvolume.html">Cast Scalar Volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="curvatureanisotropicdiffusion.html">Curvature Anisotropic Diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="gaussianblurimagefilter.html">Gaussian Blur Image Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="gradientanisotropicdiffusion.html">Gradient Anisotropic Diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="grayscalefillholeimagefilter.html">Grayscale Fill Hole Image Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="grayscalegrindpeakimagefilter.html">Grayscale Grind Peak Image Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="maskscalarvolume.html">Mask Scalar Volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="medianimagefilter.html">Median Image Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiplyscalarvolumes.html">Multiply Scalar Volumes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">N4ITK MRI Bias correction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#panels-and-their-use">Panels and their use</a></li>
<li class="toctree-l4"><a class="reference internal" href="#contributors">Contributors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="checkerboardfilter.html">CheckerBoard Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="extractskeleton.html">Extract Skeleton</a></li>
<li class="toctree-l3"><a class="reference internal" href="histogrammatching.html">Histogram Matching</a></li>
<li class="toctree-l3"><a class="reference internal" href="imagelabelcombine.html">Image Label Combine</a></li>
<li class="toctree-l3"><a class="reference internal" href="simplefilters.html">Simple Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="subtractscalarvolumes.html">Subtract Scalar Volumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="thresholdscalarvolume.html">Threshold Scalar Volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="votingbinaryholefillingimagefilter.html">Voting Binary Hole Filling Image Filter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#utilities">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#surface-models">Surface Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#converters">Converters</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#developer-tools">Developer Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#legacy-and-retired-modules">Legacy and retired modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html">Application settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide/index.html">Developer Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">3D Slicer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Modules</a></li>
      <li class="breadcrumb-item active">N4ITK MRI Bias correction</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/slicer/slicer/blob/main/Docs/user_guide/modules/n4itkbiasfieldcorrection.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="n4itk-mri-bias-correction">
<h1>N4ITK MRI Bias correction<a class="headerlink" href="#n4itk-mri-bias-correction" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Performs image bias correction using N4 algorithm. This module is based on the ITK filters contributed in the following publication:  Tustison N, Gee J “N4ITK: Nick’s N3 ITK Implementation For MRI Bias Field Correction”, The Insight Journal 2009 January-June, <a class="reference external" href="https://hdl.handle.net/10380/3053">https://hdl.handle.net/10380/3053</a></p>
</section>
<section id="panels-and-their-use">
<h2>Panels and their use<a class="headerlink" href="#panels-and-their-use" title="Link to this heading"></a></h2>
<section id="io-input-output-parameters">
<h3>IO: Input/output parameters<a class="headerlink" href="#io-input-output-parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Input Image</strong> (<em>inputImageName</em>): Input image where you observe signal inhomegeneity</p></li>
<li><p><strong>Mask Image</strong> (<em>maskImageName</em>): Binary mask that defines the structure of your interest. NOTE: This parameter is OPTIONAL. If the mask is not specified, the module will use internally Otsu thresholding to define this mask. Better processing results can often be obtained when a meaningful mask is defined.</p></li>
<li><p><strong>Output Volume</strong> (<em>outputImageName</em>): Result of processing</p></li>
<li><p><strong>Output bias field image</strong> (<em>outputBiasFieldName</em>): Recovered bias field (OPTIONAL)</p></li>
</ul>
</section>
<section id="n4-parameters">
<h3>N4 Parameters:<a class="headerlink" href="#n4-parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>BSpline grid resolution</strong> (<em>initialMeshResolution</em>): Resolution of the initial bspline grid defined as a sequence of three numbers. The actual resolution will be defined by adding the bspline order (default is 3) to the resolution in each dimension specified here. For example, 1,1,1 will result in a 4x4x4 grid of control points. This parameter may need to be adjusted based on your input image. In the multi-resolution N4 framework, the resolution of the bspline grid at subsequent iterations will be doubled. The number of resolutions is implicitly defined by Number of iterations parameter (the size of this list is the number of resolutions)</p></li>
<li><p><strong>Spline distance</strong> (<em>splineDistance</em>): An alternative means to define the spline grid, by setting the distance between the control points. This parameter is used only if the grid resolution is not specified.</p></li>
<li><p><strong>Bias field Full Width at Half Maximum</strong> (<em>bfFWHM</em>): Bias field Full Width at Half Maximum. Zero implies use of the default value.</p></li>
</ul>
</section>
<section id="advanced-n4-parameters-advanced-parameters-of-the-algorithm">
<h3>Advanced N4 Parameters: Advanced parameters of the algorithm<a class="headerlink" href="#advanced-n4-parameters-advanced-parameters-of-the-algorithm" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Number of iterations</strong> (<em>numberOfIterations</em>): Maximum number of iterations at each level of resolution. Larger values will increase execution time, but may lead to better results.</p></li>
<li><p><strong>Convergence threshold</strong> (<em>convergenceThreshold</em>): Stopping criterion for the iterative bias estimation. Larger values will lead to smaller execution time.</p></li>
<li><p><strong>BSpline order</strong> (<em>bsplineOrder</em>): Order of B-spline used in the approximation. Larger values will lead to longer execution times, may result in overfitting and poor result.</p></li>
<li><p><strong>Shrink factor</strong> (<em>shrinkFactor</em>): Defines how much the image should be upsampled before estimating the inhomogeneity field. Increase if you want to reduce the execution time. 1 corresponds to the original resolution. Larger values will significantly reduce the computation time.</p></li>
<li><p><strong>Weight Image</strong> (<em>weightImageName</em>): Weight Image</p></li>
<li><p><strong>Wiener filter noise</strong> (<em>wienerFilterNoise</em>): Wiener filter noise. Zero implies use of the default value.</p></li>
<li><p><strong>Number of histogram bins</strong> (<em>nHistogramBins</em>): Number of histogram bins. Zero implies use of the default value.</p></li>
</ul>
</section>
</section>
<section id="contributors">
<h2>Contributors<a class="headerlink" href="#contributors" title="Link to this heading"></a></h2>
<p>Nick Tustison (UPenn), Andrey Fedorov (SPL, BWH), Ron Kikinis (SPL, BWH)</p>
</section>
<section id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Link to this heading"></a></h2>
<p>The development of this module was partially supported by NIH grants R01 AA016748-01, R01 CA111288 and U01 CA151261 as well as by NA-MIC, NAC, NCIGT and the Slicer community.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="multiplyscalarvolumes.html" class="btn btn-neutral float-left" title="Multiply Scalar Volumes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="checkerboardfilter.html" class="btn btn-neutral float-right" title="CheckerBoard Filter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Slicer Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>